# Copilot Instructions for FlashLearn

## Project Overview
FlashLearn is an AI-powered flashcard generation application that uses either OpenAI or Google Gemini APIs to create personalized study materials. It features a modern dark-mode UI built with Tailwind CSS and Express.js backend with comprehensive testing.

## Technology Stack
- **Frontend**: HTML5, Vanilla JavaScript, Tailwind CSS 4.x
- **Backend**: Node.js, Express.js, Winston Logger
- **AI Providers**: OpenAI API (GPT-4), Google Gemini API
- **Testing**: Vitest 4.0.15, jsdom, supertest
- **DevOps**: Docker (multi-stage builds), Docker Compose, Makefile

## Key Files & Responsibilities
- `public/index.html` - Main UI with card display and input form
- `public/script.js` - Frontend logic (card generation, navigation, flip animation)
- `public/styles.css` - Custom CSS styles
- `server.js` - Express backend with `/api/generate-cards` endpoint
- `tests/` - Comprehensive test suite (48 tests total)
- `Dockerfile` - Production-grade multi-stage Docker image
- `Makefile` - Development automation commands

## Development Workflow
1. **Local Development**: Use `make dev` to start the development server
2. **Testing**: Run `make test` for unit tests or `make test-watch` for continuous testing
3. **Docker**: Use `make docker-up` to run containerized version
4. **Linting**: Review code for consistency with existing patterns

## Code Standards
- **JavaScript**: ES6+ syntax, no external frontend frameworks
- **Testing**: All new features must include tests (target 100% coverage)
- **Error Handling**: Use try-catch with proper error logging via Winston
- **API Calls**: Support both OpenAI and Gemini providers equally
- **Styling**: Use Tailwind CSS utility classes; avoid inline styles
- **Logging**: Use Winston logger for backend logs, console for frontend

## Environment Variables
- `AI_PROVIDER` - 'openai' or 'gemini' (defaults to 'openai')
- `OPENAI_API_KEY` - Required if using OpenAI
- `GEMINI_API_KEY` - Required if using Gemini
- `PORT` - Server port (defaults to 3000)

## Important Patterns
- **Streaming Responses**: Backend uses NDJSON format for real-time card streaming
- **Context Awareness**: Store previous card fronts to avoid repetition
- **Cost Tracking**: Calculate and log API usage costs
- **Error Messages**: User-friendly error handling with detailed backend logging

## When Making Changes
1. **Update Tests**: Ensure all tests pass with `make test`
2. **Check Coverage**: Run `make test-coverage` to verify coverage
3. **Test Locally**: Run `make dev` and manually test the UI
4. **Test Docker**: Run `make docker-up` to ensure containerization works
5. **Update Docs**: Modify README.md if adding features or changing behavior

## Common Commands
```bash
make help              # Show all available commands
make test              # Run all tests
make test-coverage     # Run tests with coverage report
make dev               # Start development server
make docker-up         # Start Docker containers
make clean             # Clean build artifacts
```

## API Endpoint
- `POST /api/generate-cards`
  - Request: `{ topic: string, context?: string[] }`
  - Response: Streaming NDJSON with card objects `{ front, back }`

## UI Features
- Auto-focus on input field on page load
- Card flip animation on click
- Previous/Next navigation
- Search/Filter functionality
- Cost estimation display
- Real-time streaming card generation
